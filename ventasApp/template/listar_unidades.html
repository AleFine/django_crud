    {% extends "index.html" %}
{% block content %}

<style>
    .drawer {
        position: fixed;
        top: 0;
        right: -400px; /* Ajusta el tamaño según sea necesario */
        width: 400px;
        height: 100%;
        background: white;
        box-shadow: -2px 0 5px rgb(0, 0, 0);
        transition: right 0.4s ease;
        z-index: 1000;
    }

    .drawer.open {
        right: 0; /* Muestra el drawer cuando está abierto */
    }

    .drawer-content {
        padding: 30px;
        color: black; 
    }

    .btn-custom {
        background-color: #007bff; /* Color de fondo azul */
        color: white; /* Color de texto blanco */
        border: 1px solid transparent; /* Borde transparente por defecto */
        transition: background-color 0.3s ease, border-color 0.3s ease; /* Efecto de transición */
        padding: 10px 20px; /* Aumentar el padding para hacer el botón más grande */
        font-size: 16px; /* Aumentar el tamaño de la fuente */
        margin-left: 40px;
    }

    .btn-danger.btn-custom {
        background-color: #dc3545; /* Color de fondo rojo para el botón de cerrar */
        margin-right: 10px;
    }

    .btn-custom:hover {
        background-color: #0056b3; /* Color más oscuro cuando se pasa el mouse (para el botón azul) */
        border-color: #0056b3; /* Borde del mismo color más oscuro */
    }

    .btn-danger.btn-custom:hover {
        background-color: #c82333; /* Color más oscuro cuando se pasa el mouse (para el botón rojo) */
        border-color: #c82333; /* Borde del mismo color más oscuro */
    }

    .custom-input {
        border: 1px solid #000; /* Color del borde */
        padding: 0.5rem; /* Espaciado interno */
        font-size: 1rem; /* Tamaño de fuente */
        transition: border-color 0.3s ease; /* Transición suave para el color del borde */
    }

    /* Estilo al pasar el mouse */
    .custom-input:focus {
        border-color: #0056b3; /* Color del borde al enfocar */
        outline: none; /* Quitar el contorno por defecto */
    }

    /* Estilo al pasar el mouse (opcional) */
    .custom-input:hover {
        border-color: #0056b3; /* Cambia el color del borde al pasar el mouse */
    }


</style>

<div class="mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10">
    <div class="mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
        <h2 class="text-title-md2 font-bold text-black dark:text-white">Ratios</h2>
        <nav>
            <ol class="flex items-center gap-2">
                <li>
                    <a class="font-medium" href="index.html">MANTENEDOR /</a>
                </li>
                <li class="font-medium text-primary">Ratios</li>
            </ol>
        </nav>
    </div>

<<<<<<< Updated upstream

    <div class="flex justify-between ">
        <form action="{% url 'listar_unidades' %}" method="GET" class="flex items-center bg-white shadow-md rounded-md overflow-hidden dark:bg-gray-800 max-w-md">
            <input 
                type="text" 
                name="search" 
                class="form-input px-4 py-2 w-full text-black dark:text-black dark:bg-gray-700 focus:ring-2 focus:ring-blue-600 focus:border-transparent rounded-none" 
                placeholder="Buscar unidad" 
                value="{{ request.GET.search }}"> 
            <button 
                type="submit" 
                class="px-4 py-2 transition duration-200 ease-in-out">
                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 12 12">
                    <path fill="currentColor" d="M5 1a4 4 0 1 0 2.248 7.31l2.472 2.47a.75.75 0 1 0 1.06-1.06L8.31 7.248A4 4 0 0 0 5 1M2.5 5a2.5 2.5 0 1 1 5 0a2.5 2.5 0 0 1-5 0"/>
                </svg>
            </button>
        </form>
        <a href="{% url 'agregar_unidades' %}" class="px-4 py-2 bg-blue-600 text-black rounded hover:bg-blue-700">Añadir</a>
    </div>
=======
>>>>>>> Stashed changes
    <div class="p-2"></div>
    <div class="flex flex-col gap-64">
        <div class="rounded-sm border border-stroke bg-white px-5 pb-2.5 pt-6 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1">
            <table class="w-full table-auto">
                <thead>
                    <tr class="bg-gray-2 text-left dark:bg-meta-4">
                        <th class="min-w-[220px] px-4 py-4 font-medium text-black dark:text-white xl:pl-11">Código</th>
                        <th class="min-w-[150px] px-4 py-4 font-medium text-black dark:text-white">Ratios</th>
                        <th class="min-w-[150px] px-4 py-4 font-medium text-black dark:text-white">Formúla</th>
                        <th class="min-w-[120px] px-2 py-4 font-medium text-black dark:text-white">Operación</th>
                    </tr>
                </thead>
                <tbody>
                    {% if unidad %}
                        {% for itemunidad in unidad %}
                            <tr>
                                <td class="border-b border-[#eee] px-4 py-5 pl-9 dark:border-strokedark xl:pl-11">
                                    <h5 class="font-medium text-black dark:text-white">{{ itemunidad.id }}</h5>
                                </td>
                                <td class="border-b border-[#eee] px-10 py-5 dark:border-strokedark">
                                    <p class="text-black dark:text-white">{{ itemunidad.ratio }}</p>
                                </td>
                                <td class="border-b border-[#eee] px-10 py-5 dark:border-strokedark">
                                    <p class="text-black dark:text-white">{{ itemunidad.formula }}</p>
                                </td>
                                <td class="border-b border-[#eee] px-4 py-5 dark:border-strokedark">
                                    <div class="flex items-center space-x-3.5">
                                        <button title="Editar" class="hover:text-primary" onclick="openEditDrawer({{ itemunidad.id }}, '{{ itemunidad.ratio }}', '{{ itemunidad.formula }}', '{{ itemunidad.operacion }}')">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 24 24">
                                                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"/>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        <tr style="text-align: center;">
                            <td colspan="4">
                                <p>No hay Registros</p>
                            </td>
                        </tr>
                    {% endif %}
                </tbody>                
            </table>
        </div>
    </div>
</div>

<!-- Drawer -->
<!-- Drawer -->
<div id="editDrawer" class="drawer" aria-labelledby="editDrawerLabel" role="dialog" aria-modal="true">
    <div class="drawer-content">
        <h5 id="editDrawerLabel" class="text-xl font-bold">Calcular Ratio</h5>
        <button type="button" class="btn-close" onclick="closeEditDrawer()" aria-label="Close"></button>
        <form id="editForm" onsubmit="event.preventDefault(); calculateFormula();">
            <div class="mb-4">
                <label for="ratio" class="form-label font-bold">Ratio</label><br>
                <input type="text" class="form-control custom-input" id="ratio" required readonly style="width: 100%; max-width: 400px;">
            </div>
            <div class="mb-4">
                <label for="formula" class="form-label font-bold">Fórmula</label><br>
                <input type="text" class="form-control custom-input" id="formula" required readonly style="width: 100%; max-width: 400px;">
            </div>
            <div class="mb-4">
                <label for="operation" class="form-label font-bold">Operación</label><br>
                <input type="text" class="form-control custom-input" id="operation" required style="width: 100%; max-width: 400px;">
            </div>
            <input type="hidden" id="itemId">
            <div class="d-flex justify-content-between mt-4">
                <button type="button" class="btn btn-danger btn-custom" onclick="closeEditDrawer()">Cerrar</button>
                <button type="submit" class="btn btn-primary btn-custom">Calcular</button>
            </div>            
        </form>
    </div>
</div>




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    function closeEditDrawer() {
        document.getElementById('editDrawer').classList.remove('open');
    }

    function openEditDrawer(id, ratio, formula, operation) {
        document.getElementById('itemId').value = id;
        document.getElementById('ratio').value = ratio;
        document.getElementById('formula').value = formula;
        document.getElementById('operation').value = operation;

        document.getElementById('editDrawer').classList.add('open');
    }

    function calculateFormula() {
        const ratio = document.getElementById('ratio').value;
        const formula = document.getElementById('formula').value;
        const operation = document.getElementById('operation').value;

        let result;
        try {
            result = eval(operation); 
        } catch (error) {
            alert("Error en la operación: " + error.message);
            return;
        }


        alert(`El resultado es: ${result}`);
        closeEditDrawer(); 
    }

</script>

{% endblock %}


